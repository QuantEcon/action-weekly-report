# Release v2.1.0 - Regex Support for Repository Exclusion

**Release Date:** October 20, 2025

## Overview

Minor feature release adding **regex pattern support** to the `exclude-repos` option, making it much easier to exclude groups of repositories with similar naming patterns.

---

## ✨ New Feature: Regex Support

### Problem Solved

**Before:** To exclude multiple auto-generated repositories, you had to list each one individually:
```yaml
exclude-repos: 'lecture-python.notebooks,lecture-julia.notebooks,lecture-datascience.notebooks'
```

**After:** Use a single regex pattern to match all:
```yaml
exclude-repos: 'lecture-.*\.notebooks'
```

### How It Works

The `--exclude` / `exclude-repos` option now supports:
1. **Exact match** (backward compatible): `repo1,repo2`
2. **Regex patterns** (new): `lecture-.*\.notebooks`
3. **Mixed usage**: `specific-repo,pattern-.*,another-repo`

Patterns are matched using `grep -E` extended regular expressions.

---

## 🚀 Usage Examples

### CLI Mode

```bash
# Exclude all .notebooks repositories
./generate-report.sh --token=ghp_xxx --exclude="lecture-.*\.notebooks"

# Exclude multiple patterns
./generate-report.sh --token=ghp_xxx --exclude="lecture-.*\.notebooks,.*-archive"

# Mix exact names and patterns
./generate-report.sh --token=ghp_xxx --exclude="old-repo,test-.*,.*-deprecated"
```

### GitHub Actions

```yaml
- name: Generate activity report
  uses: QuantEcon/action-weekly-report@v2.1
  with:
    github-token: ${{ secrets.GITHUB_TOKEN }}
    exclude-repos: 'lecture-.*\.notebooks,.*-archive'
```

---

## 📋 Pattern Examples

| Pattern | Matches | Example |
|---------|---------|---------|
| `lecture-.*\.notebooks` | All repos starting with "lecture-" and ending with ".notebooks" | lecture-python.notebooks |
| `.*-archive` | All repos ending with "-archive" | old-project-archive |
| `test-.*` | All repos starting with "test-" | test-integration |
| `.*\.(notebooks\|archive)` | All repos ending with ".notebooks" or ".archive" | data.notebooks |
| `^quantecon-.*` | All repos starting with "quantecon-" | quantecon-book-theme |

---

## 🔧 Technical Details

### Implementation

**Key change in filtering logic:**
```bash
# Before: Exact string comparison
if [ "$repo" = "$exclude_repo" ]; then
    excluded=true
fi

# After: Regex matching with grep -E
if echo "$repo" | grep -qE "^${exclude_pattern}$"; then
    excluded=true
fi
```

### Features
- Uses `grep -E` for extended regular expressions
- Patterns are anchored (^...$) for full string matching
- Supports standard regex syntax (., *, +, ?, [], (), |, etc.)
- 100% backward compatible with exact names

### Debug Output

When using regex patterns, the script shows which pattern matched:
```
Excluding repositories matching: lecture-.*\.notebooks,.*-archive
Excluding repository: lecture-python.notebooks (matched pattern: lecture-.*.notebooks)
Excluding repository: lecture-julia.notebooks (matched pattern: lecture-.*.notebooks)
Excluding repository: old-project-archive (matched pattern: .*-archive)
```

---

## 📚 Documentation Updates

All documentation has been updated to include regex examples:
- ✅ `README.md` - CLI usage examples
- ✅ `action.yml` - Input description
- ✅ `generate-report.sh` - Help text with examples
- ✅ `docs/improvements.md` - Technical details
- ✅ `CHANGELOG.md` - Release notes

---

## 🔄 Migration Guide

### Backward Compatibility

**100% backward compatible** - existing workflows continue to work without changes.

### No Changes Required

If you're already using `exclude-repos` with exact names:
```yaml
exclude-repos: 'repo1,repo2,repo3'
```

This continues to work exactly as before. No action needed.

### Optional Upgrade

To take advantage of regex patterns:
```yaml
# Old way (still works)
exclude-repos: 'lecture-python.notebooks,lecture-julia.notebooks,lecture-datascience.notebooks'

# New way (more concise)
exclude-repos: 'lecture-.*\.notebooks'
```

---

## 🧪 Validation

### Test Results

Tested with the following patterns:

**Pattern:** `lecture-.*\.notebooks,.*-archive`

| Repository | Result | Matched Pattern |
|------------|--------|----------------|
| lecture-python.notebooks | ❌ Excluded | lecture-.*.notebooks |
| lecture-julia.notebooks | ❌ Excluded | lecture-.*.notebooks |
| lecture-datascience.notebooks | ❌ Excluded | lecture-.*.notebooks |
| regular-repo | ✅ Included | - |
| another-repo | ✅ Included | - |
| test-archive | ❌ Excluded | .*-archive |
| my-archive | ❌ Excluded | .*-archive |

### Real-World Testing

Successfully tested with QuantEcon organization:
- Pattern `lecture-.*\.notebooks` correctly excludes all 15+ lecture notebook repositories
- Pattern `.*-archive` correctly excludes all archived project repositories
- Exact names still work for specific exclusions

---

## 🎯 Use Cases

### 1. Exclude Auto-Generated Repositories
```bash
--exclude="lecture-.*\.notebooks"
```
Useful for QuantEcon's auto-generated notebook repositories.

### 2. Exclude Archived Projects
```bash
--exclude=".*-archive,.*-deprecated"
```
Hide old archived repositories from reports.

### 3. Exclude Test/Development Repos
```bash
--exclude="test-.*,dev-.*,.*-sandbox"
```
Focus on production repositories only.

### 4. Exclude Specific Project Groups
```bash
--exclude="legacy-.*,prototype-.*"
```
Filter out legacy or experimental projects.

---

## 📊 Impact

### Before v2.1.0
- Had to list each repository individually
- Long, hard-to-maintain exclude lists
- Error-prone when adding new repos with similar patterns

### After v2.1.0
- Single pattern matches multiple repos
- Concise, maintainable configuration
- New repos automatically excluded if they match pattern

### Example Improvement

**Before:**
```yaml
exclude-repos: 'lecture-python.notebooks,lecture-julia.notebooks,lecture-datascience.notebooks,lecture-stats.notebooks,lecture-jax.notebooks,lecture-gpu.notebooks,lecture-scientificcomputing.notebooks,lecture-dle.notebooks,lecture-networks.notebooks,lecture-tools-techniques.notebooks,lecture-web-scraping.notebooks,lecture-r.notebooks,lecture-parallel.notebooks,lecture-python-intro.notebooks,lecture-intro.notebooks'
```

**After:**
```yaml
exclude-repos: 'lecture-.*\.notebooks'
```

**Reduction:** 95% shorter configuration! 🎉

---

## 🐛 Known Issues

None. This is a pure additive feature with full backward compatibility.

---

## 💡 Tips

### 1. Test Your Patterns First

Use the script locally to verify patterns match correctly:
```bash
./generate-report.sh --token=ghp_xxx --exclude="your-pattern-.*" 2>&1 | grep "Excluding"
```

### 2. Escape Special Characters

Remember to escape regex special characters:
- `.` → `\.` (literal dot)
- `*` → `.*` (any characters)
- `?` → `\?` (literal question mark)

### 3. Use Quotes

Always quote patterns that contain special characters:
```bash
--exclude="lecture-.*\.notebooks"  # ✅ Good
--exclude=lecture-.*\.notebooks     # ❌ May fail due to shell expansion
```

---

## 🔗 Links

- **Documentation:** [docs/](../)
- **Technical Details:** [docs/improvements.md](../improvements.md)
- **Changelog:** [CHANGELOG.md](../../CHANGELOG.md)
- **Repository:** [QuantEcon/action-weekly-report](https://github.com/QuantEcon/action-weekly-report)

---

## 📝 Summary

Version 2.1.0 adds a powerful yet simple feature that makes repository exclusion much more flexible and maintainable. Perfect for organizations with systematic naming conventions like QuantEcon's `.notebooks` repositories.

**Upgrade to take advantage of regex patterns and simplify your configuration!** 🚀
